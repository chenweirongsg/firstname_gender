# firstname_gender prediction model generated by chen weirong

Inside we have the following scripts: 
1. jupyter notebook ("ncs_assignmnet model_exploration_process.ipynb") which stores the thinking process and tunning process for generating firstname_gender prediction model. 
2. requirements.txt stores the python pkg and version used in this project
3. Modelling.py (with Modelling.ipynb) and Testing.py (with Testing.ipynb) for you to do modelling, prediction or validation.
4. Sample training file (training_file.csv) and sample prediction file (prediction.csv)
5. ncs_flask.py for you to run the modelling/prediction/validation by flask python
6. Modelling_model.py and Testing_model.py are the model files used by ncs_flask.py
7. logger folder is for you to store the status logger file.

# ===Using flask=== #
Step 0:
change dir to current working dir that contains the ncs_flask.py, Testing_model.py and Modelling_model.py, and run the following code:
- python ncs_flask.py
- Get the url which it is running on (for example: Running on http://127.0.0.1:5000/ )

# How to do the Modelling #
Type the following url and run:
- url_running_on/ncs_modelling/$input_training_file/$output_model_dir/$output_encoder_filename/$n_max/$status_file_dir/$working_dir
- eg: http://127.0.0.1:5000/ncs_modelling/training_file.csv/LSTM_model/encoder.pkl/15/logger/dir_to_ur_doc/Documents/ncs_project


note:
1. training_file.csv shall contain the firstname and gender
2. n_max is the max length of the firstname, in orginal training dataset, it is 15.
3. status_file will store the testing accuracy for the model trained based on the current training file
4. working_dir is the dir you are working on, so for other input argv, please do not add this working_dir in front of them.
5. data type: working_dir => path, n_max => int, all others are stirng


# How to do the prediction #
Type the following url and run:
- url_running_on/ncs_testing/$input_testing_file/predict/$model_dir/$encoder_filename/$status_file_dir/$n_max/$working_dir
- eg: http://127.0.0.1:5000/ncs_testing/prediction.csv/predict/LSTM_model/encoder.pkl/logger/15/dir_to_ur_doc/Documents/ncs_project

note:
1. input_testing_file shall only contain the firstname
2. n_max is the max length of the firstname, it shall be the same as the one used in the model
3. encoder_filename is the encoder used in the trained model
4. The predicted gender will be added to the original input_testing_file
5. working_dir is the dir you are working on, so for other input argv, please do not add this working_dir in front of them.
6. data type: working_dir => path, n_max => int, all others are stirng


# How to do the validation #
Type the following url and run:
- url_running_on/ncs_testing/$input_testing_file/validation/$model_dir/$encoder_filename/$status_file_dir/$n_max/$working_dir
- eg: http://127.0.0.1:5000/ncs_testing/training_file.csv/validation/LSTM_model/encoder.pkl/logger/15/dir_to_ur_doc/Documents/ncs_project


note:
1. input_testing_file shall contain the firstname and gender
2. n_max is the max length of the firstname, it shall be the same as the one used in the model
3. encoder_filename is the encoder used in the trained model
4. The predicted gender will be added to the original input_testing_file
5. The status file will store the validation accuracy for the current testing file.
6. working_dir is the dir you are working on, so for other input argv, please do not add this working_dir in front of them.
7. data type: working_dir => path, n_max => int, all others are stirng


# ===Using normal python shell run=== #
# How to do the Modelling #
run the following code:
- python Modelling.py $input_training_file $output_model_dir $output_encoder_filename $n_max $status_file_dir
- eg: python Modelling.py /ncs_project/training_file.csv /ncs_project/LSTM_model /ncs_project/encoder.pkl 15 /ncs_project/logger

note:
1. training_file.csv shall contain the firstname and gender
2. n_max is the max length of the firstname, in orginal training dataset, it is 15.
3. status_file will store the testing accuracy for the model trained based on the current training file

# How to do the Prediction #
run the following code:
- python Testing.py $input_testing_file predict $model_dir $encoder_filename $status_file_dir $n_max
- eg: python Testing.py /ncs_project/prediction.csv predict /ncs_project/LSTM_model /ncs_project/encoder.pkl /ncs_project/logger 15

note:
1. input_testing_file shall only contain the firstname
2. n_max is the max length of the firstname, it shall be the same as the one used in the model
3. encoder_filename is the encoder used in the trained model
4. The predicted gender will be added to the original input_testing_file

# How to do the Validation #
run the following code:
- python Testing.py $input_testing_file validation $model_dir $encoder_filename $status_file_dir $n_max
- eg: python Testing.py /ncs_project/training_file.csv validation /ncs_project/LSTM_model /ncs_project/encoder.pkl /ncs_project/logger 15

note:
1. input_testing_file shall contain the firstname and gender
2. n_max is the max length of the firstname, it shall be the same as the one used in the model
3. encoder_filename is the encoder used in the trained model
4. The predicted gender will be added to the original input_testing_file
5. The status file will store the validation accuracy for the current testing file.


# Current Accuracy based on the name_gender.csv #
- Training Accuracy: 0.89
- Testing Accuracy: 0.88
- Validation Accuracy: 0.88

