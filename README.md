# firstname_gender prediction model generated by chen weirong

Inside we have the following scripts: 
1. jupyter notebook ("ncs_assignmnet model_exploration_process.ipynb") which stores the thinking process and tunning process for generating firstname_gender prediction model.
2. requirements.txt stores the python pkg and version used in this project
3. Modelling.py (with Modelling.ipynb) and Testing.py (with Testing.ipynb) for you to do modelling, prediction or validation.
4. Sample training file (training_file.csv) and sample prediction file (prediction.csv)


## How to start the Modelling ##
run the following code:
python Modelling.py $input_training_file $output_model_dir $output_encoder_filename $n_max $status_file_dir
(eg: python Modelling.py /ncs_project/training_file.csv /ncs_project/LSTM_model /ncs_project/encoder.pkl 15 /ncs_project)

note:
1. training_file.csv shall contain the firstname and gender
2. n_max is the max length of the firstname, in orginal training dataset, it is 15.
3. status_file will store the testing accuracy for the model trained based on the current training file

## How to do the Prediction ##
run the following code:
python Testing.py $input_testing_file predict $model_dir $encoder_filename $status_file_dir $n_max
(eg: python Testing.py /ncs_project/prediction.csv predict /ncs_project/LSTM_model /ncs_project/encoder.pkl /ncs_project 15)

note:
1. input_testing_file shall only contain the firstname
2. n_max is the max length of the firstname, it shall be the same as the one used in the model
3. encoder_filename is the encoder used in the trained model
4. The predicted gender will be added to the original input_testing_file

## How to do the Validation ##
run the following code:
python Testing.py $input_testing_file validation $model_dir $encoder_filename $status_file_dir $n_max
(eg: python Testing.py /ncs_project/training_file.csv validation /ncs_project/LSTM_model /ncs_project/encoder.pkl /ncs_project 15)

note:
1. input_testing_file shall contain the firstname and gender
2. n_max is the max length of the firstname, it shall be the same as the one used in the model
3. encoder_filename is the encoder used in the trained model
4. The predicted gender will be added to the original input_testing_file
5. The status file will stored the validation accuracy for the current testing file.
